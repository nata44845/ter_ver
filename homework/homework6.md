# Урок 6. Сравнение долей. Построение доверительного интервала

## Задание 1
Известно, что генеральная совокупность распределена нормально со средним квадратическим отклонением, равным 16.
Найти доверительный интервал для оценки математического ожидания a с надежностью 0.95, если выборочная средняя M = 80, а объем выборки n = 256.

a=0.05
s=16
x=80
n=256
se = s / n ** 0.5
z_tabl = stats.norm.ppf(1-(a/2))
print(f'[{round(x - se * z_tabl,2)}, {round(x + se * z_tabl,2)}]')
[78.04, 81.96]

## Задание 2
В результате 10 независимых измерений некоторой величины X, выполненных с одинаковой точностью, получены опытные данные:

6.9, 6.1, 6.2, 6.8, 7.5, 6.3, 6.4, 6.9, 6.7, 6.1

Предполагая, что результаты измерений подчинены нормальному закону распределения вероятностей, оценить истинное значение величины X при помощи доверительного интервала, покрывающего это значение с доверительной вероятностью 0,95.

x = np.array([6.9, 6.1, 6.2, 6.8, 7.5, 6.3, 6.4, 6.9, 6.7, 6.1])
n = len(x)
m = np.mean(x)
s = np.std(x, ddof=1)
a = 0.05
se = s / n ** 0.5
t_tabl = stats.t.ppf(1-a/2,n-1)

print(f'[{round(m - se * t_tabl,2)}, {round(m + se * t_tabl,2)}]')
[6.27, 6.91]

## Задание 3
Рост дочерей 175, 167, 154, 174, 178, 148, 160, 167, 169, 170
Рост матерей  178, 165, 165, 173, 168, 155, 160, 164, 178, 175

Используя эти данные построить 95% доверительный интервал для разности среднего роста родителей и детей.

x1 = np.array([175, 167, 154, 174, 178, 148, 160, 167, 169, 170])
x2 = np.array([178, 165, 165, 173, 168, 155, 160, 164, 178, 175])
m1 = np.mean(x1)
m2 = np.mean(x2)
delta = m2 - m1
s1 = np.std(x1, ddof=1)
s2 = np.std(x2, ddof=1)
D = (s1 ** 2 + s2 ** 2) / 2
n1 = n2 = len(x1)
se = (D / n1 + D / n2) ** 0.5
t_tabl = stats.t.ppf(0.975, n1 + n2 - 2)
print(f'{m1}, {m2}')
print(f'{s1}, {s2}')
print(f'{t_tabl}')
print(f'[{round(delta - t_tabl * se,4)}, {round(delta + se * t_tabl,4)}]')

166.2, 168.1
9.542885657214313, 7.752418977325723
2.10092204024096
[-6.2684, 10.0684]